/**
 * jQuery Stalactite : Lightweight Element Packing
 * Examples and documentation at: http://jonobr1.github.com/stalactite
 * Copyright (c) 2011 Jono Brandel
 * Version: 0.1 (8-SEPTEMBER-2011)
 * Requires: jQuery v1.6.2 or later
 *
 * Copyright 2011 jonobr1
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

(function(a){function t(a){for(var a=a[0],h=-1,c=0;c<e.length;c++)if(a===e[c].dom){h=c;break}return h}function x(a,h){var c=a.children().not(h.cssSelector);h.cssPrep&&c.css({position:"relative",display:"inline-block",verticalAlign:"top",opacity:0,zIndex:-1});return c}function m(a,h,c,e){e=a.children().addClass(e.cssSelector);a={x:a.offset().left+(a.outerWidth()-a.width())/2,y:a.offset().top+(a.outerHeight()-a.height())/2};h.apply(this,[e,a,c.prevMinIndex,c.prevMaxIndex,c.i])}var e=[];a.fn.stalactite=
function(l){function h(f){var b=f.offset().left+(f.outerWidth()-f.width())/2,f=f.offset().top+(f.outerHeight()-f.height())/2,c=a("#stalactite-loader");0>=c.length&&(c=a('<p class="stalactite-loader" style="display: none;"/>'));d.centerLoader?c.css({position:"absolute",top:a(window).height()/2,left:a(window).width()/2}).html(d.loader).appendTo("body"):c.css({position:"absolute",top:f,left:b}).html(d.loader).appendTo("body");c.find("img").load(function(){c.fadeIn()})}function c(c,b,e){b=a.extend({},
b,d.styles);b.opacity==c.css("opacity")&&delete b.opacity;c.css("z-index","auto").stop().animate(b,d.duration,d.easing,e)}var u=!1,d=a.extend({},a.fn.stalactite.defaultOptions,l);d.cssSelector=d.cssPrefix+"-loaded";return this.each(function(){function f(b,h,l,j,k){if(k>=b.length)e[p]?e[p]=a.extend(e[p],g):e.push(a.extend({dom:b.parent("div")[0]},g)),d.complete.apply(this),a(d.cssPrefix+"-loader").fadeOut();else if(u&&d.fluid)a(d.cssPrefix+"-loader").fadeOut();else{var n=a(b[k]),i=a(b[k-1]),m=n.offset().left,
q=m+n.outerWidth(),s=n.offset().top;n.outerHeight();0<i.length&&m<i.offset().left&&0<k&&k!==g.i&&(r++,g.row=r,g.prevMinIndex=l=j,g.prevMaxIndex=j=k-1,g.i=k);var o=0;if(0<r){for(var v=j;v>=l;v--){var i=a(b[v]),w=i.offset().left,t=w+i.outerWidth(),i=i.offset().top+i.outerHeight();w>=q||t<=m||o<i&&(o=i)}o-=s}else o=-parseInt(n.css("margin-top").toString().replace("px",""));c(n,{opacity:1,marginTop:"+="+o},function(){f(b,h,l,j,k+1)})}}var b=a(this),j=null,l=x(b,d);h(b);var p=t(b),g={row:0,prevMinIndex:0,
prevMaxIndex:0,i:0};0<=p&&0<b.children().index(l[0])&&(g=e[p]);var r=g.row;d.fluid&&(b.css("width","auto"),a(window).bind("resize",function(){j?clearTimeout(j):h(b);u=!0;j=setTimeout(function(){u=!1;j=null;r=0;g={row:0,prevMinIndex:0,prevMaxIndex:0,i:0};e=[];m(b,f,g,d)},2E3)}));var q=b.children().not(d.cssSelector).find("img, embed, iframe, audio, video, div");b.find(":not(img, embed, iframe, audio, video, div)");var s=0;0<q.length?q.each(function(){var e=a(this).load(function(){c(e);s++;s>=q.length&&
m(b,f,g,d)})}):m(b,f,g,d)})};a.fn.stalactite.defaultOptions={duration:150,easing:"swing",cssPrefix:".stalactite",cssPrep:!0,fluid:!0,loader:'<img src="data:image/gif;base64, R0lGODlhEAAQAPQAAP///zMzM/n5+V9fX5ycnDc3N1FRUd7e3rm5uURERJGRkYSEhOnp6aysrNHR0WxsbHd3dwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAAFUCAgjmRpnqUwFGwhKoRgqq2YFMaRGjWA8AbZiIBbjQQ8AmmFUJEQhQGJhaKOrCksgEla+KIkYvC6SJKQOISoNSYdeIk1ayA8ExTyeR3F749CACH5BAkKAAAALAAAAAAQABAAAAVoICCKR9KMaCoaxeCoqEAkRX3AwMHWxQIIjJSAZWgUEgzBwCBAEQpMwIDwY1FHgwJCtOW2UDWYIDyqNVVkUbYr6CK+o2eUMKgWrqKhj0FrEM8jQQALPFA3MAc8CQSAMA5ZBjgqDQmHIyEAIfkECQoAAAAsAAAAABAAEAAABWAgII4j85Ao2hRIKgrEUBQJLaSHMe8zgQo6Q8sxS7RIhILhBkgumCTZsXkACBC+0cwF2GoLLoFXREDcDlkAojBICRaFLDCOQtQKjmsQSubtDFU/NXcDBHwkaw1cKQ8MiyEAIfkECQoAAAAsAAAAABAAEAAABVIgII5kaZ6AIJQCMRTFQKiDQx4GrBfGa4uCnAEhQuRgPwCBtwK+kCNFgjh6QlFYgGO7baJ2CxIioSDpwqNggWCGDVVGphly3BkOpXDrKfNm/4AhACH5BAkKAAAALAAAAAAQABAAAAVgICCOZGmeqEAMRTEQwskYbV0Yx7kYSIzQhtgoBxCKBDQCIOcoLBimRiFhSABYU5gIgW01pLUBYkRItAYAqrlhYiwKjiWAcDMWY8QjsCf4DewiBzQ2N1AmKlgvgCiMjSQhACH5BAkKAAAALAAAAAAQABAAAAVfICCOZGmeqEgUxUAIpkA0AMKyxkEiSZEIsJqhYAg+boUFSTAkiBiNHks3sg1ILAfBiS10gyqCg0UaFBCkwy3RYKiIYMAC+RAxiQgYsJdAjw5DN2gILzEEZgVcKYuMJiEAOwAAAAAAAAAAAA==" />',
centerLoader:!1,styles:{},complete:function(a){return a}}})(jQuery);
